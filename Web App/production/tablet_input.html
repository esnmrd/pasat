<!DOCTYPE html>
<html lang="fa">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- jQuery -->
    <script src="../vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="../vendors/fastclick/lib/fastclick.js"></script>
    <!-- NProgress -->
    <script src="../vendors/nprogress/nprogress.js"></script>
    <!-- bootstrap-jalali-datepicker -->
    <script src="../vendors/bootstrap-jalali-datepicker/bootstrap-datepicker.js"></script>
    <script src="../vendors/bootstrap-jalali-datepicker/bootstrap-datepicker.fa.js"></script>
    <!-- Ion.RangeSlider -->
    <script src="../vendors/ion.rangeSlider/js/ion.rangeSlider.min.js"></script>
    <!-- PNotify -->
    <script src="../vendors/pnotify/dist/pnotify.js"></script>
    <script src="../vendors/pnotify/dist/pnotify.buttons.js"></script>
    <script src="../vendors/pnotify/dist/pnotify.nonblock.js"></script>
    <!-- JDate -->
    <script src="../vendors/jdate/build/jdate.js"></script>
    <!-- Custom Theme Scripts -->
    <script src="../build/js/custom.min.js"></script>
    <!-- bootstrap-jalali-datepicker -->
    <script>
        $(document).ready(function() {
            $("#date").datepicker();
            $("#date").datepicker("setDate", new Date());
        });
    </script>
    <!-- /bootstrap-jalali-datepicker -->
    <!-- My Scripts -->
    <script>
        function setLines() {
            var currentSystem = window.localStorage.getItem("username");
            var systems = JSON.parse(window.localStorage.getItem("systems"));
            var lineNumber = document.getElementById("lineNumber");
            lineNumber.innerHTML = "";
            var lineNumberOptions = systems[currentSystem].lines;
            for (var i = 0; i < lineNumberOptions.length; i++) {
                var opt = lineNumberOptions[i];
                var el = document.createElement("option");
                el.textContent = opt;
                el.value = opt;
                lineNumber.appendChild(el);
            }
            var interviewerName = document.getElementById("interviewerName");
            var direction = document.getElementById("direction");
            if (window.localStorage.getItem("lastChosenLineNumber")) {
                lineNumber.value = window.localStorage.getItem("lastChosenLineNumber");
            }
            if (window.localStorage.getItem("lastEnteredInterviewerName")) {
                interviewerName.value = window.localStorage.getItem("lastEnteredInterviewerName");
            }
            if (window.localStorage.getItem("lastChosenDirection")) {
                direction.value = window.localStorage.getItem("lastChosenDirection");
            }
        }
        
        function setStations() {
            var stations = JSON.parse(window.localStorage.getItem("stations"));
            var lineNumber = document.getElementById("lineNumber").value;
            var direction = document.getElementById("direction").value;
            var origin = document.getElementById("origin"); 
            origin.innerHTML = "";
            var originOptions = stations[lineNumber][direction];
            for (var i = 0; i < originOptions.length; i++) {
                var opt = originOptions[i];
                var el = document.createElement("option");
                el.textContent = opt;
                el.value = opt;
                origin.appendChild(el);
            }
            var destination = document.getElementById("destination");
            destination.innerHTML = "";
            var destinationOptions = stations[lineNumber][direction];
            for (var i = 0; i < destinationOptions.length; i++) {
                var opt = destinationOptions[i];
                var el = document.createElement("option");
                el.textContent = opt;
                el.value = opt;
                destination.appendChild(el);
            }
            if (window.localStorage.getItem("lastChosenOrigin")) {
                origin.value = window.localStorage.getItem("lastChosenOrigin");
            }
            if (window.localStorage.getItem("lastChosenDestination")) {
                destination.value = window.localStorage.getItem("lastChosenDestination");
            }
        }

        function ping(url, callback) {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.timeout = 5000;
            xmlHttp.open("GET", url, true); // true for asynchronous
            xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState === 4 && xmlHttp.status == 200) {
                    var jsonResponse = JSON.parse(xmlHttp.responseText);
                    callback(jsonResponse["serverStatus"]);
                } else if (xmlHttp.readyState === 4 && xmlHttp.status == 0) {
                    callback("down");
                }
            };
            xmlHttp.ontimeout = function() {
                new PNotify({
                    text: "سرور در حال حاضر پاسخگو نیست! لطفا اندکی بعد مجدداً تلاش فرمایید.",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
                callback("down");
            };
            xmlHttp.send();
        }
        
        function uploadToServer() {
            if (navigator.onLine == false) {
                new PNotify({
                    text: "ارتباط اینترنتی قطع است!",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
            } else {
                ping("http://91.98.156.148:8888/?sender=ping", uploadToServerCallback);
            }
        }

        function uploadToServerCallback(pingResponse) {
            if (pingResponse == "up") {
                var lastCreatedIndex = window.localStorage.getItem("lastCreatedRecordIndex");
                var lastUploadedIndex = window.localStorage.getItem("lastUploadedRecordIndex");
                if (parseInt(lastUploadedIndex) < parseInt(lastCreatedIndex)) {
                    document.getElementById("uploadToServerButton").disabled = true;
                    NProgress.start();
                    for (key = parseInt(lastUploadedIndex) + 1; key <= parseInt(lastCreatedIndex); key++) {
                        var url = "http://91.98.156.148:8888/?sender=tabletInput&json=";
                        var jsonDict = {};
                        var arrayData = JSON.parse(window.localStorage.getItem(key.toString()));
                        jsonDict["lineNumber"] = arrayData[0];
                        var dateParts = arrayData[1].split("/");
                        var dd = parseInt(dateParts[2]);
                        var mm = parseInt(dateParts[1]);
                        var yyyy = parseInt(dateParts[0]);
                        var JDate = require("jdate");
                        var jalaliDate = new JDate([yyyy, mm, dd]);
                        var georgianDate = jalaliDate._d;
                        dd = georgianDate.getDate();
                        mm = georgianDate.getMonth() + 1;
                        yyyy = georgianDate.getFullYear();
                        var hour = parseInt(arrayData[2]);
                        var minute = parseInt(arrayData[3]);
                        var tempDate = new Date(yyyy, mm - 1, dd, hour, minute);
                        var timeStamp = tempDate.getTime() / 1000;
                        jsonDict["timeStamp"] = timeStamp;
                        jsonDict["interviewerName"] = arrayData[4];
                        jsonDict["direction"] = arrayData[5];
                        jsonDict["origin"] = arrayData[6];
                        jsonDict["destination"] = arrayData[7];
                        jsonDict["interiorCleanness"] = parseFloat(arrayData[8]);
                        jsonDict["exteriorCleanness"] = parseFloat(arrayData[9]);
                        jsonDict["driverTreatment"] = parseFloat(arrayData[10]);
                        jsonDict["drivingQuality"] = parseFloat(arrayData[11]);
                        jsonDict["airConditioningQuality"] = parseFloat(arrayData[12]);
                        jsonDict["noiseLevel"] = parseFloat(arrayData[13]);
                        jsonDict["overallQuality"] = parseFloat(arrayData[14]);
                        jsonDict["gender"] = parseInt(arrayData[15]);
                        jsonDict["educationLevel"] = parseInt(arrayData[16]);
                        jsonDict["age"] = parseInt(arrayData[17]);
                        jsonDict["tripPurpose"] = parseInt(arrayData[18]);
                        jsonDict["weeklyTripFrequency"] = parseInt(arrayData[19]);
                        jsonDict["phone"] = arrayData[20];
                        url += JSON.stringify(jsonDict);
                        var xmlHttp = new XMLHttpRequest();
                        xmlHttp.timeout = 5000;
                        xmlHttp.open("GET", url, true); // true for asynchronous
                        xmlHttp.onreadystatechange = function() {
                            if (xmlHttp.readyState === 4 && xmlHttp.status == 200) {
                                var serverResponse = JSON.parse(xmlHttp.responseText);
                            }
                        }
                        xmlHttp.ontimeout = function() {
                            callback("Request timed out!");
                        };
                        xmlHttp.send();
                    }
                    window.localStorage.setItem("lastUploadedRecordIndex", lastCreatedIndex);
                    NProgress.done();
                    document.getElementById("uploadToServerButton").disabled = false;
                    new PNotify({
                        text: "تمامی رکوردهای جدید به سرور آپلود گردید.",
                        type: "success",
                        styling: "bootstrap3",
                        delay: 2000
                    });
                } else {
                    new PNotify({
                        text: "رکورد جدیدی برای آپلود وجود ندارد!",
                        type: "error",
                        styling: "bootstrap3",
                        delay: 2000
                    });
                }
            }
        }
        
        function updateForm() {
            if (navigator.onLine == false) {
                new PNotify({
                    text: "ارتباط اینترنتی قطع است!",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
            } else {
                ping("http://91.98.156.148:8888/?sender=ping", updateFormCallback);
            }
        }
        
        function updateFormCallback(pingResponse) {
            if (pingResponse == "up") {
                url = "http://91.98.156.148:8888/?sender=updateForm"
                var xmlHttp = new XMLHttpRequest();
                xmlHttp.timeout = 5000;
                xmlHttp.open("GET", url, true); // true for asynchronous
                xmlHttp.onreadystatechange = function() {
                    if (xmlHttp.readyState === 4 && xmlHttp.status == 200) {
                        var serverResponse = JSON.parse(xmlHttp.responseText);
                        window.localStorage.setItem("systems", serverResponse["systems"]);
                        window.localStorage.setItem("stations", serverResponse["stations"]);
                        new PNotify({
                            text: "فرم نظرسنجی به روز رسانی شد.",
                            type: "success",
                            styling: "bootstrap3",
                            delay: 2000
                        });
                        setTimeout(function() {
                            window.location.reload();
                        }, 2000);
                    }
                }
                xmlHttp.ontimeout = function() {
                    callback("Request timed out!");
                };
                xmlHttp.send();
            } else {
                new PNotify({
                    text: "سرور در حال حاضر پاسخگو نیست! لطفا اندکی بعد مجدداً تلاش فرمایید.",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
            }
        }

        function convertDataToCSV() {
            var result, columnDelimiter, lineDelimiter;
            var lastCreatedIndex = window.localStorage.getItem("lastCreatedRecordIndex");
            columnDelimiter = ",";
            lineDelimiter = "\n";
            result = "";
            result += "شماره خط اتوبوسرانی" + columnDelimiter + "تاریخ انجام مصاحبه" + columnDelimiter + "ساعت" + columnDelimiter + "دقیقه" + columnDelimiter + "نام مصاحبه گر" + columnDelimiter + "جهت حرکت در خط" + columnDelimiter + "ایستگاه مبدا" + columnDelimiter + "ایستگاه مقصد" + columnDelimiter + "نظافت داخلی" + columnDelimiter + "نظافت خارجی" + columnDelimiter + "رفتار راننده با مسافران" + columnDelimiter + "کیفیت رانندگی" + columnDelimiter + "تهویه و دما" + columnDelimiter + "آلودگی صوتی" + columnDelimiter + "کیفیت کلی" + columnDelimiter + "جنسیت" + columnDelimiter + "سطح تحصیلات" + columnDelimiter + "سن" + columnDelimiter + "هدف سفر" + columnDelimiter + "تواتر سفر در هفته" + columnDelimiter + "شماره تلفن همراه" + lineDelimiter;
            for (key = 1; key <= parseInt(lastCreatedIndex); key++) {
                var arrayData = JSON.parse(window.localStorage.getItem(key.toString()));
                for (i = 0; i <= 20; i++) {
                    result += arrayData[i];
                    if (i < 20) {
                        result += columnDelimiter;
                    } else {
                        result += lineDelimiter;
                    }
                }
            }
            return result;
        }

        function saveToCSV(args) {
            var data, fileName, link;
            var csv = convertDataToCSV();
            var BOM = "\uFEFF";
            var csv = BOM + csv;
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth() + 1;
            var yyyy = today.getFullYear();
            dd = fixFormat(dd);
            mm = fixFormat(mm);
            var today = mm + "-" + dd + "-" + yyyy;
            fileName = today + ".csv";
            if (!csv.match(/^data:text\/csv/i)) {
                csv = "data:text/csv;charset=utf-8," + csv;
            }
            data = encodeURI(csv);
            link = document.createElement("a");
            link.setAttribute("href", data);
            link.setAttribute("download", fileName);
            link.click();
            new PNotify({
                text: "دیتابیس در فایل ذخیره سازی شد.",
                type: "success",
                styling: "bootstrap3",
                delay: 2000
            });
        }

        function buttonGroupCheckedValueSet(name, checkedValue) {
            $('input[name="' + name + '"][value="' + checkedValue + '"]').closest(".btn").button("toggle");
        }

        /*
        function clearDatabase() {
            if (confirm("آیا در مورد پاکسازی دیتابیس اطمینان دارید؟")) {
                window.localStorage.clear();
                new PNotify({
                    text: "دیتابیس به طور کامل پاکسازی شد.",
                    type: "success",
                    styling: "bootstrap3",
                    delay: 2000
                });
                setTimeout(function() {
                    window.location.reload();
                }, 2000);
            } else {
                // Do nothing!
            }
        }
        */

        function fetchDataIntoForm(key) {
            var arrayData = JSON.parse(window.localStorage.getItem(key));
            if (arrayData != undefined) {
                document.getElementById("lineNumber").value = arrayData[0];
                document.getElementById("date").value = arrayData[1];
                document.getElementById("interviewerName").value = arrayData[4];
                document.getElementById("direction").value = arrayData[5];
                document.getElementById("origin").value = arrayData[6];
                document.getElementById("destination").value = arrayData[7];
                buttonGroupCheckedValueSet("interiorCleanness", arrayData[8]);
                buttonGroupCheckedValueSet("exteriorCleanness", arrayData[9]);
                buttonGroupCheckedValueSet("driverTreatment", arrayData[10]);
                buttonGroupCheckedValueSet("drivingQuality", arrayData[11]);
                buttonGroupCheckedValueSet("airConditioningQuality", arrayData[12]);
                buttonGroupCheckedValueSet("noiseLevel", arrayData[13]);
                buttonGroupCheckedValueSet("overallQuality", arrayData[14]);
                buttonGroupCheckedValueSet("gender", arrayData[15]);
                buttonGroupCheckedValueSet("educationLevel", arrayData[16]);
                buttonGroupCheckedValueSet("age", arrayData[17]);
                buttonGroupCheckedValueSet("tripPurpose", arrayData[18]);
                buttonGroupCheckedValueSet("weeklyTripFrequency", arrayData[19]);
                document.getElementById("phone").value = arrayData[20];
            }
        }

        function currentTime() {
            var today = new Date();
            var h = today.getHours();
            var m = today.getMinutes();
            var s = today.getSeconds();
            m = fixFormat(m);
            s = fixFormat(s);
            document.getElementById("clock").innerHTML = h + ":" + m + ":" + s + " :زمان کنونی";
            var t = setTimeout(currentTime, 1000);
        }

        function fixFormat(i) {
            if (i < 10) {
                i = "0" + i
            };
            return i;
        }

        function saveChanges() {
            if (document.getElementById("date").value != "" && document.getElementById("interviewerName").value != "") {
                var today = new Date();
                var hour = today.getHours();
                var minute = today.getMinutes();
                var arrayData = [
                    document.getElementById("lineNumber").value,
                    document.getElementById("date").value,
                    hour.toString(),
                    minute.toString(),
                    document.getElementById("interviewerName").value,
                    document.getElementById("direction").value,
                    document.getElementById("origin").value,
                    document.getElementById("destination").value,
                    $('input[name="interiorCleanness"]:checked').val(),
                    $('input[name="exteriorCleanness"]:checked').val(),
                    $('input[name="driverTreatment"]:checked').val(),
                    $('input[name="drivingQuality"]:checked').val(),
                    $('input[name="airConditioningQuality"]:checked').val(),
                    $('input[name="noiseLevel"]:checked').val(),
                    $('input[name="overallQuality"]:checked').val(),
                    $('input[name="gender"]:checked').val(),
                    $('input[name="educationLevel"]:checked').val(),
                    $('input[name="age"]:checked').val(),
                    $('input[name="tripPurpose"]:checked').val(),
                    $('input[name="weeklyTripFrequency"]:checked').val(),
                    document.getElementById("phone").value
                ];
                window.localStorage.setItem("lastChosenLineNumber", arrayData[0]);
                window.localStorage.setItem("lastEnteredInterviewerName", arrayData[4]);
                window.localStorage.setItem("lastChosenDirection", arrayData[5]);
                window.localStorage.setItem("lastChosenOrigin", arrayData[6]);
                window.localStorage.setItem("lastChosenDestination", arrayData[7]);
                var currentIndex = window.localStorage.getItem("currentRecordIndex");
                window.localStorage.setItem(currentIndex, JSON.stringify(arrayData));
                var lastCreatedIndex = window.localStorage.getItem("lastCreatedRecordIndex");
                if (parseInt(currentIndex) > parseInt(lastCreatedIndex)) {
                    window.localStorage.setItem("lastCreatedRecordIndex", currentIndex);
                }
                document.getElementById("nextButton").disabled = false;
                document.getElementById("saveToCSVButton").disabled = false;
                document.getElementById("uploadToServerButton").disabled = false;
                new PNotify({
                    text: "تغییرات اعمال شده در رکورد ذخیره شد.",
                    type: "success",
                    styling: "bootstrap3",
                    delay: 2000
                });
            } else {
                if (document.getElementById("date").value == "") {
                    new PNotify({
                        text: "انتخاب تاریخ انجام مصاحبه الزامی است!",
                        type: "error",
                        styling: "bootstrap3",
                        delay: 2000
                    });
                }
                if (document.getElementById("interviewerName").value == "") {
                    new PNotify({
                        text: "درج نام مصاحبه گر الزامی است!",
                        type: "error",
                        styling: "bootstrap3",
                        delay: 2000
                    });
                }
            }
        }

        function showNextRecord() {
            var currentIndex = window.localStorage.getItem("currentRecordIndex");
            tempIndex = parseInt(currentIndex) + 1;
            currentIndex = tempIndex.toString();
            window.localStorage.setItem("currentRecordIndex", currentIndex);
            window.location.reload();
        }

        function showPreviousRecord() {
            var currentIndex = window.localStorage.getItem("currentRecordIndex");
            tempIndex = parseInt(currentIndex) - 1;
            currentIndex = tempIndex.toString();
            window.localStorage.setItem("currentRecordIndex", currentIndex);
            window.location.reload();
        }
        
        function login() {
            username = document.getElementById("username").value;
            password = document.getElementById("password").value;
            systems = JSON.parse(window.localStorage.getItem("systems"));
            if (!(systems)) {
                document.getElementById("username").value = "";
                document.getElementById("password").value = "";
                new PNotify({
                    text: "ابتدا نسبت به روز رسانی فرم اقدام نمایید!",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
            } else if (!(systems.hasOwnProperty(username))) {
                new PNotify({
                    text: "نام کاربری وجود ندارد!",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
            } else if (!(systems[username].password == password)) {
                new PNotify({
                    text: "رمز عبور نادرست است!",
                    type: "error",
                    styling: "bootstrap3",
                    delay: 2000
                });
            } else {
                window.localStorage.setItem("username", username);
                window.location.reload();
            }
        }
        
        function logout() {
            if (confirm("در صورت خروج، دیتابیس مصاحبه های انجام شده توسط کاربر فعلی پاکسازی خواهد شد. آیا مطمئن هستید؟")) {
                window.localStorage.clear();
                window.location.reload();
            } else {
                // Do nothing!
            }
        }

        window.onload = function() {
            $("html, body").animate({ scrollTop: 0 }, "slow");
            username = window.localStorage.getItem("username");
            if (username != undefined) {
                currentTime();
                var currentIndex = window.localStorage.getItem("currentRecordIndex");
                var lastCreatedIndex = window.localStorage.getItem("lastCreatedRecordIndex");
                if (currentIndex != undefined) {
                    document.getElementById("recordIndex").innerHTML = currentIndex + " :اندیس رکورد";
                    if (parseInt(currentIndex) > 1) {
                        document.getElementById("previousButton").disabled = false;
                    } else {
                        document.getElementById("previousButton").disabled = true;
                    }
                    if (parseInt(currentIndex) > parseInt(lastCreatedIndex)) {
                        document.getElementById("nextButton").disabled = true;
                    } else {
                        document.getElementById("nextButton").disabled = false;
                    }
                    if (parseInt(lastCreatedIndex) > 0) {
                        document.getElementById("saveToCSVButton").disabled = false;
                        document.getElementById("uploadToServerButton").disabled = false;
                    }
                    fetchDataIntoForm(currentIndex);
                } else {
                    window.localStorage.setItem("currentRecordIndex", "1");
                    window.localStorage.setItem("lastCreatedRecordIndex", "0");
                    window.localStorage.setItem("lastUploadedRecordIndex", "0");
                    document.getElementById("recordIndex").innerHTML = "1" + " :اندیس رکورد";
                }
                setLines();
                setStations();
                document.getElementById("lineNumber").addEventListener("change", function() {
                    setStations();
                });
                document.getElementById("direction").addEventListener("change", function() {
                    setStations();
                });             
                $("#surveyForm").show();
                $("#loginForm").hide();
            } else {
                $("#surveyForm").hide();
                $("#loginForm").show();
            }
        }
    </script>
    <!-- /My Scripts -->

    <head>
        <title>فرم سنجش رضایت مندی مسافر</title>
        <!-- Bootstrap -->
        <link href="../vendors/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
        <!-- Font Awesome -->
        <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <!-- NProgress -->
        <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
        <!-- bootstrap-jalali-datepicker -->
        <link rel="stylesheet" href="../vendors/bootstrap-jalali-datepicker/bootstrap-datepicker.css">
        <!-- Ion.RangeSlider -->
        <link href="../vendors/normalize-css/normalize.css" rel="stylesheet">
        <link href="../vendors/ion.rangeSlider/css/ion.rangeSlider.css" rel="stylesheet">
        <link href="../vendors/ion.rangeSlider/css/ion.rangeSlider.skinFlat.css" rel="stylesheet">
        <!-- PNotify -->
        <link href="../vendors/pnotify/dist/pnotify.css" rel="stylesheet">
        <link href="../vendors/pnotify/dist/pnotify.buttons.css" rel="stylesheet">
        <link href="../vendors/pnotify/dist/pnotify.nonblock.css" rel="stylesheet">
        <!-- Custom Theme Style -->
        <link href="../build/css/custom.css" rel="stylesheet">
    </head>

    <body style="background: #f7f7f7;">
        <div class="login" name="loginForm" id="loginForm">
            <div class="login_wrapper">
                <div class="animate form login_form">
                    <section class="login_content">
                        <h2>ورود مصاحبه گر</h2>
                        <div class="x_title">
                            <div class="clearfix"></div>
                        </div>
                        <br/>
                        <div class="form-group">
                            <div>
                                <input type="text" class="form-control" placeholder="نام کاربری" name="username" id="username" style="direction: rtl;"/>
                            </div>
                            <div class="clearfix"></div>
                            <br/>
                            <div>
                                <input type="password" class="form-control" placeholder="رمز عبور" name="password" id="password" style="direction: rtl;"/>
                            </div>
                            <div class="clearfix"></div>
                            <br/>
                            <div>
                                <button class="btn btn-primary btn-block" name="loginButton" id="loginButton" onclick="login();">ورود به فرم نظرسنجی <i class="fa fa-sign-in"></i></button>
                                <button class="btn btn-warning btn-block" name="updateFormFirstButton" id="updateFormFirstButton" onclick="updateForm();">به روز رسانی فرم <i class="fa fa-refresh"></i></button>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
        <div class="nav-md" name="surveyForm" id="surveyForm" style="display: none;">
            <div class="container body">
                <div class="main_container">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-md-12 top_row menu_fixed">
                        <div class="navbar nav_title_2">
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-2">
                                <img src="images/bus_logo.png" alt="Bus Logo" style="display: block; margin: auto; width: 120px;">
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-4">
                                <div class="site_title">فرم سنجش رضایت مندی مسافر</div>
                                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                    <div id="clock" class="site_title" style="text-transform: none;"></div>
                                </div>
                                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                    <div id="recordIndex" class="site_title" style="text-transform: none;"></div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-2">
                                <img src="images/ut_logo.png" alt="UT Logo" style="display: block; margin: auto; width: 45px;">
                            </div>
                    </div>
                        <br />
                    </div>
                    <!-- page content -->
                    <div class="middle_row" role="main">
                        <div class="clearfix"></div>
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="x_panel">
                                    <div class="x_title">
                                        <h2>اطلاعات عمومی مصاحبه</h2>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="x_content">
                                        <form class="form-horizontal form-label-left">
                                            <div class="form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <input type="text" name="interviewerName" id="interviewerName" required="required" class="form-control" style="direction: rtl;" tabindex="3">
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12" style="text-align: center;">نام مصاحبه گر</label>
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <input id="date" type="text" class="form-control" style="direction: rtl;" readonly="true" tabindex="2">
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12" style="text-align: center;">تاریخ انجام مصاحبه</label>
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <select name="lineNumber" id="lineNumber" class="form-control" style="direction: rtl;" tabindex="1">
                                                    </select>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">شماره خط اتوبوسرانی</label>
                                            </div>
                                            <div class="clearfix"></div>
                                            <br/>
                                            <div class="form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <select name="destination" id="destination" class="form-control" style="direction: rtl;" tabindex="6">
                                                    </select>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12" for="destination" style="text-align: center;">ایستگاه مقصد</label>
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <select name="origin" id="origin" class="form-control" style="direction: rtl;" tabindex="5">
                                                    </select>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12" for="origin" style="text-align: center;">ایستگاه مبدأ</label>
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <select name="direction" id="direction" class="form-control" style="direction: rtl;" tabindex="4">
                                                        <option value="raft">رفت</option>
                                                        <option value="bargasht">برگشت</option>
                                                    </select>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12" for="direction">جهت حرکت در خط</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="x_panel">
                                    <div class="x_title">
                                        <h2>سوالات اصلی مصاحبه</h2>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="x_content">
                                        <form class="form-horizontal form-label-left">
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                                <img src="images/angry.png" alt="Angry Emoji" style="display: block; margin: auto; width: 48px;">
                                                <br/>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                                <img src="images/sad.png" alt="Sad Emoji" style="display: block; margin: auto; width: 48px;">
                                                <br/>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                                <img src="images/neutral.png" alt="Neutral Emoji" style="display: block; margin: auto; width: 48px;">
                                                <br/>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                                <img src="images/happy.png" alt="Happy Emoji" style="display: block; margin: auto; width: 48px;">
                                                <br/>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                                <img src="images/lol.png" alt="Lol Emoji" style="display: block; margin: auto; width: 48px;">
                                                <br/>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12"></div>
                                            <div class="form-group">
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12" tabindex="0">
                                                    <div id="interiorCleanness" class="btn-group btn-group-justified" data-toggle="buttons">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="interiorCleanness" id="interiorCleanness" value="0">غیرقابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="interiorCleanness" id="interiorCleanness" value="50">ضعیف
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="interiorCleanness" id="interiorCleanness" value="66.67" checked="checked">متوسط
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="interiorCleanness" id="interiorCleanness" value="83.33">خوب
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="interiorCleanness" id="interiorCleanness" value="100">عالی
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">نظافت داخلی</label>
                                                <div class="clearfix"></div>
                                                <br/>
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="exteriorCleanness" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="exteriorCleanness" id="exteriorCleanness" value="0">غیرقابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="exteriorCleanness" id="exteriorCleanness" value="50">ضعیف
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="exteriorCleanness" id="exteriorCleanness" value="66.67" checked="checked">متوسط
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="exteriorCleanness" id="exteriorCleanness" value="83.33">خوب
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="exteriorCleanness" id="exteriorCleanness" value="100">عالی
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">نظافت خارجی</label>
                                                <div class="clearfix"></div>
                                                <br/>
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="driverTreatment" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="driverTreatment" id="driverTreatment" value="0">غیرقابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="driverTreatment" id="driverTreatment" value="50">ضعیف
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="driverTreatment" id="driverTreatment" value="66.67" checked="checked">متوسط
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="driverTreatment" id="driverTreatment" value="83.33">خوب
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="driverTreatment" id="driverTreatment" value="100">عالی
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">رفتار راننده با مسافران</label>
                                                <div class="clearfix"></div>
                                                <br/>
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="drivingQuality" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="drivingQuality" id="drivingQuality" value="0">غیرقابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="drivingQuality" id="drivingQuality" value="50">ضعیف
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="drivingQuality" id="drivingQuality" value="66.67" checked="checked">متوسط
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="drivingQuality" id="drivingQuality" value="83.33">خوب
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="drivingQuality" id="drivingQuality" value="100">عالی
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">کیفیت رانندگی</label>
                                                <div class="clearfix"></div>
                                                <br/>
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="airConditioningQuality" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="airConditioningQuality" id="airConditioningQuality" value="0">غیرقابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="airConditioningQuality" id="airConditioningQuality" value="50">ضعیف
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="airConditioningQuality" id="airConditioningQuality" value="66.67" checked="checked">متوسط
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="airConditioningQuality" id="airConditioningQuality" value="83.33">خوب
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="airConditioningQuality" id="airConditioningQuality" value="100">عالی
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">تهویه و دما</label>
                                                <div class="clearfix"></div>
                                                <br/>
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="noiseLevel" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="noiseLevel" id="noiseLevel" value="0">آزاردهنده
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="noiseLevel" id="noiseLevel" value="50">زیاد
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="noiseLevel" id="noiseLevel" value="66.67" checked="checked">قابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="noiseLevel" id="noiseLevel" value="83.33">کم
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="noiseLevel" id="noiseLevel" value="100">وجود ندارد
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">آلودگی صوتی</label>
                                            </div>
                                            <div class="ln_solid"></div>
                                            <div class="form-group">
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="overallQuality" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="overallQuality" id="overallQuality" value="0">غیرقابل تحمل
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="overallQuality" id="overallQuality" value="50">ضعیف
                                                        </label>
                                                        <label class="btn btn-info active">
                                                            <input type="radio" name="overallQuality" id="overallQuality" value="66.67" checked="checked">متوسط
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="overallQuality" id="overallQuality" value="83.33">خوب
                                                        </label>
                                                        <label class="btn btn-info">
                                                            <input type="radio" name="overallQuality" id="overallQuality" value="100">عالی
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">کیفیت کلی</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="x_panel">
                                    <div class="x_title">
                                        <h2>اطلاعات مصاحبه شونده</h2>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="x_content">
                                        <form class="form-horizontal form-label-left">
                                            <div class="form-group">
                                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12"></div>
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                                                    <div id="gender" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="gender" id="gender" value="0">زن
                                                        </label>
                                                        <label class="btn btn-primary active">
                                                            <input type="radio" name="gender" id="gender" value="1" checked="checked">مرد
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">جنسیت</label>
                                                <div class="clearfix"></div>
                                                <br/>
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="educationLevel" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="educationLevel" id="educationLevel" value="5">فوق لیسانس یا بالاتر
                                                        </label>
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="educationLevel" id="educationLevel" value="4">لیسانس
                                                        </label>
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="educationLevel" id="educationLevel" value="3">فوق دیپلم
                                                        </label>
                                                        <label class="btn btn-primary active">
                                                            <input type="radio" name="educationLevel" id="educationLevel" value="2" checked="checked">دیپلم
                                                        </label>
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="educationLevel" id="educationLevel" value="1">سیکل یا پایین تر
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">سطح تحصیلات</label>
                                            </div>
                                            <div class="clearfix"></div>
                                            <br/>
                                            <div class="form-group">
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div id="age" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="age" id="age" value="5">بالای ۵۰ سال
                                                        </label>
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="age" id="age" value="4">بین ۴۰ تا ۵۰ سال
                                                        </label>
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="age" id="age" value="3">بین ۳۰ تا ۴۰ سال
                                                        </label>
                                                        <label class="btn btn-primary active">
                                                            <input type="radio" name="age" id="age" value="2" checked="checked">بین ۲۰ تا ۳۰ سال
                                                        </label>
                                                        <label class="btn btn-primary">
                                                            <input type="radio" name="age" id="age" value="1">زیر ۲۰ سال
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">سن</label>
                                            </div>
                                            <div class="ln_solid"></div>
                                            <div class="form-group">
                                                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
                                                    <div data-toggle="buttons">
                                                        <div id="tripPurpose" class="btn-group btn-group-justified" tabindex="0">
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="5">دیدار اقوام
                                                            </label>
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="4">امور اداری
                                                            </label>
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="3">تحصیل
                                                            </label>
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="2">خرید
                                                            </label>
                                                            <label class="btn btn-success active">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="1" checked="checked">کار
                                                            </label>
                                                        </div>
                                                        <div class="clearfix"></div>
                                                        <br/>
                                                        <div id="tripPurpose" class="btn-group btn-group-justified">
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="9">سایر
                                                            </label>
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="8">بازگشت به خانه
                                                            </label>
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="7">تفریح
                                                            </label>
                                                            <label class="btn btn-success">
                                                                <input type="radio" name="tripPurpose" id="tripPurpose" value="6">بهداشت و درمان
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">هدف سفر</label>
                                            </div>
                                            <div class="clearfix"></div>
                                            <br/>
                                            <div class="form-group">
                                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                    <input type="text" name="phone" id="phone" required="required" class="form-control" style="direction: rtl;" tabindex="7">
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12" for="phone" style="text-align: center;">شماره تلفن همراه</label>
                                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                    <div id="weeklyTripFrequency" class="btn-group btn-group-justified" data-toggle="buttons" tabindex="0">
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="8">8+
                                                        </label>
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="7">7
                                                        </label>
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="6">6
                                                        </label>
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="5">5
                                                        </label>
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="4">4
                                                        </label>
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="3">3
                                                        </label>
                                                        <label class="btn btn-success">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="2">2
                                                        </label>
                                                        <label class="btn btn-success active">
                                                            <input type="radio" name="weeklyTripFrequency" id="weeklyTripFrequency" value="1" checked="checked">1
                                                        </label>
                                                    </div>
                                                </div>
                                                <label class="control-label col-lg-2 col-md-2 col-sm-2 col-xs-12">تواتر سفر در هفته</label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /page content -->
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 bottom_row menu_fixed">
                    <div class="navbar nav_title_2">
                        <div class="col-lg-7 col-md-7 col-sm-7 col-xs-12">
                            <button class="btn btn-danger" name="logoutButton" id="logoutButton" onclick="logout();">خروج و پاکسازی دیتابیس <i class="fa fa-sign-out"></i></button>
                            <button class="btn btn-success" name="uploadToServerButton" id="uploadToServerButton" onclick="uploadToServer();" disabled>آپلود به سرور <i class="fa fa-upload"></i></button>
                            <button class="btn btn-info" name="saveToCSVButton" id="saveToCSVButton" onclick="saveToCSV();" disabled>ذخیره در فایل <i class="fa fa-download"></i></button>
                            <button class="btn btn-warning" name="updateFormSecondButton" id="updateFormSecondButton" onclick="updateForm();">به روز رسانی فرم <i class="fa fa-refresh"></i></button>
                        </div>
                        <div class="col-lg-5 col-md-5 col-sm-5 col-xs-12" style="text-align: right;">
                            <button class="btn btn-primary" name="previousButton" id="previousButton" onclick="showPreviousRecord();" disabled><i class="fa fa-arrow-left"></i> رکورد قبلی</button>
                            <button class="btn btn-dark" name="saveButton" id="saveButton" onclick="saveChanges();">ذخیره تغییرات <i class="fa fa-save"></i> </button>
                            <button class="btn btn-primary" name="nextButton" id="nextButton" onclick="showNextRecord();" disabled>رکورد بعدی <i class="fa fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>